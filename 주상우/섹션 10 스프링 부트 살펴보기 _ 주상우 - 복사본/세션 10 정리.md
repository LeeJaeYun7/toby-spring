# 세션 10 정리

### **스프링 부트의 자동 구성(auto-configuration) 기능**

![20231220_085844.png](%E1%84%89%E1%85%A6%E1%84%89%E1%85%A7%E1%86%AB%2010%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%200940b35dabc24305bf8b18eb3a4f5cb4/20231220_085844.png)

1. **사용 기술 선택**
    - 개발자가 프로젝트를 시작할 때 필요한 기술 스택을 선택 (ex . Spring Core , JPA.. )
2. **Spring Initializr**
    - 프로젝트를 생성하기 위해 Spring Initializr를 사용
        - 프로젝트의 초기 구조를 만들고 필요한 설정 파일과 빌드 관리 파일(**`build.gradle`** 또는 **`pom.xml`**)을 포함함
3. **build.gradle 설정**
    - **`build.gradle`** 파일에는 프로젝트에 필요한 Spring Boot 스타터(starter)와 의존성(dependencies)이 명시
        - 이 스타터들은 Spring Boot가 자동으로 구성할 수 있는 라이브러리와 프레임워크를 포함함
4. **Springboot Starter + Dependencies**
    - 스타터와 의존성들이 프로젝트에 포함되면, Spring Boot는 이들을 기반으로 자동 구성을 수행
5. **클래스/라이브러리 찾기**
    - Spring Boot는 클래스패스(classpath) 상에서 사용 가능한 클래스와 라이브러리를 검색
    
6. **@AutoConfiguration**
    - **`@AutoConfiguration`** 어노테이션을 사용하여 Spring Boot는 조건에 따라 애플리케이션을 자동으로 구성
        - 이 과정에서 **`AutoConfiguration.imports`**를 통해 여러 자동-구성 클래스들이 임포트
        - 이 어노테이션이 적용된 클래스는 스프링 부트가 조건에 따라 자동으로 구성할 수 있는 후보
        - 스프링 부트는 클래스패스에 있는 라이브러리들, 스타터(Starter)들, 그리고 여러분이 **`build.gradle`** 또는 **`pom.xml`**에 추가한 의존성들을 기반으로 이러한 자동 구성 클래스들을 찾움
    - **`AutoConfiguration.imports`**
        - **`@AutoConfiguration`** 어노테이션을 가진 클래스들은 보통 **`@Import`** 어노테이션을 사용하여 다른 설정 클래스들을 가져옴
        - **`AutoConfiguration.imports`**는 이러한 추가적인 구성 클래스들을 임포트하는 역할을 함
7. **지정 구성 활성 조건** 
    - **`@Conditional`** 어노테이션을 사용하여 특정 조건에 따라 자동 구성을 활성화하거나 비활성화
    - 이 어노테이션은 **`@AutoConfiguration`** 클래스 내에 있는 빈(bean) 정의들에 조건을 붙임
        - 예를 들어, 특정 클래스가 클래스패스에 존재하거나, 특정 프로퍼티가 설정되어 있거나, 특정한 환경이 맞을 때만 빈을 등록하도록 함
        - 이는 자동 구성이 환경에 맞게 탄력적으로 적용될 수 있도록 함
    - **`@Conditional`** 어노테이션은 자동 구성에 대한 조건들을 평가하고, 조건들을 만족하는 경우에만 해당 빈을 애플리케이션 컨텍스트에 등록
        - 이렇게 등록된 빈들은 "디폴트 상태"로 초기화 됨  (아래 내용 )
        - 디폴트 상태'라는 용어는 빈이 갖는 기본적인 속성 값들로 준비된 상태를 의미
        - 개발자는 이 디폴트 설정을 그대로 사용할 수도 있고, 필요에 따라 자신의 설정으로 오버라이드하여 커스터마이징할 수 있음
        - 이러한 메커니즘을 통해, 스프링 부트는 개발자가 복잡한 설정 작업 없이도 빠르게 애플리케이션을 개발하고, 실행할 수 있도록 지원함

1. 디폴트 자동 구성 인프라 빈 
    - 스프링 부트의 자동 구성 시스템은 **`@Conditional`** 어노테이션을 통해 조건부 빈(bean) 등록
    - 이 과정에서 개발자가 프로젝트 생성 시 선택한 기술 및 의존성이 큰 역할을 함
        - 이것이 바로 Spring Initializr를 사용할 때 어떤 스타터(Starter)와 의존성(Dependency)을 선택하느냐에 따라 결정되는 것
    - 적용 되는 것
        - 선택한 스타터와 의존
            - 이니셜라이저에서 프로젝트를 생성할 때 선택한 스타터와 의존성은 어떤 자동 구성이 적용될지 결정하는 기준이 됨
                - EX>  **`spring-boot-starter-web`**을 추가하면 Spring MVC와 관련된 자동 구성이 활성화
        - **외부 설정 파일에서의 프로퍼티**
            - **`application.properties`**나 **`application.yml`** 같은 외부 설정 파일에서 정의한 프로퍼티들은 자동 구성의 조건을 더 세분화하거나 변경할 수 있음
                - EX > 데이터베이스 연결 정보나 서버 포트 등을 설정할 수 있습니다.
2. **프로퍼티 소스**
    - **`application.properties`** 또는 **`application.yml`** 파일을 통해 애플리케이션의 구성을 더욱 세부적으로 조정 가능
        - 이 파일은 데이터베이스 연결 설정, 서버 포트, 로깅 레벨 등을 정의할 수 있음
3. **외부설정 프로퍼티 적용**
    - 이 설정 파일들의 프로퍼티들은 스프링 부트의 자동 구성 과정에 적용되어 애플리케이션의 행동 방식을 결정
    

스프링 부트가 개발자가 처음 프로젝트를 생성하는 순간부터, 실행 가능한 애플리케이션까지 어떻게 자동으로 구성되는지를 주는 프로세스, 스프링 부트는 이런 방식으로 많은 설정 작업을 자동화하며, 개발자가 비즈니스 로직에 더 집중할 수 있도록 도와줍니다. 

 스프링 이니셜라이저(Spring Initializr)를 통해 프로젝트를 생성하고 의존성을 선택할 때, 그 선택들은 **`@Conditional`** 어노테이션을 통해 평가되는 주요한 판단 기준이 됩니다. 추가적으로 **`application.properties`**나 **`application.yml`** 같은 외부 설정 파일을 통해 주어진 프로퍼티들이 자동 구성의 조건을 변경할 수도 있습니다.

최종적으로, 이러한 조건들을 모두 만족하는 자동 구성 클래스들이 애플리케이션 컨텍스트(application context)에 빈으로 등록됩니다. 이들 빈은 기본 설정(디폴트 값)을 가지고 초기화되며, 개발자는 필요에 따라 이 값을 오버라이드(override)하여 커스터마이징할 수 있습니다.

요약하자면, 스프링 부트의 자동 구성은 여러분이 선택한 기술과 설정들을 기반으로, 애플리케이션에 필요한 인프라 구성 요소들을 자동으로 설정하고, 조건에 따라 이러한 설정을 조정합니다. 이 과정을 통해 개발자는 인프라 설정에 적게 신경 쓰고, 비즈니스 로직 개발에 더 많은 시간을 할애할 수 있습니다.

### 컴포넌트 스캔 대상으로 만들어진 클래스 빈 등록

![Untitled](%E1%84%89%E1%85%A6%E1%84%89%E1%85%A7%E1%86%AB%2010%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%200940b35dabc24305bf8b18eb3a4f5cb4/Untitled.png)

스프링 프레임워크에서 **`@ComponentScan`**과 **`@Component`** 어노테이션을 사용하여 어플리케이션의 컴포넌트를 스캔하고 빈(bean)으로 등록하는 과정을 도식화한 것

1. **`@ComponentScan`**: 이 어노테이션은 스프링이 컴포넌트들을 찾을 수 있도록 지정된 패키지(혹은 패키지들)를 스캔하게 합니다. 기본적으로, **`@ComponentScan`**은 선언된 클래스가 위치한 패키지와 그 하위 패키지들을 스캔합니다. 개발자는 이 어노테이션을 사용하여 스프링에게 어느 패키지를 탐색해야 하는지 알려줍니다.
2. **지정 빈 등록**: 스캔하는 동안, **`@Component`** 어노테이션이 붙어있는 클래스는 스프링 컨테이너에 의해 빈으로 자동 등록됩니다. 이렇게 등록된 빈은 스프링 컨테이너가 관리하며, 의존성 주입(Dependency Injection) 등의 과정에 사용될 수 있습니다.
3. **`@Component` 어노테이션**: 이 어노테이션은 해당 클래스가 스프링 컨테이너에 의해 관리되는 컴포넌트임을 나타냅니다. **`@Controller`**, **`@Service`**, **`@Repository`** 등은 **`@Component`**의 특수한 형태로, 각각 컨트롤러, 서비스, 리포지토리 컴포넌트를 정의할 때 사용됩니다.

이 과정은 스프링이 애플리케이션을 구성하는 주요 요소들을 자동으로 찾아내고 관리할 수 있게 해주며, 개발자가 수동으로 각각의 빈을 정의하고 등록하는 수고를 덜어줍니다. 컴포넌트 스캔은 스프링의 핵심 기능 중 하나로, 스프링 기반 애플리케이션의 구성을 단순화하고 자동화하는 데 큰 역할을 합니다.

### 자동 구성 인프라스트럭처 빈

![20231220_093132.png](%E1%84%89%E1%85%A6%E1%84%89%E1%85%A7%E1%86%AB%2010%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%200940b35dabc24305bf8b18eb3a4f5cb4/20231220_093132.png)

도식에 표시된 "자동 구성 인프라스트럭처 빈"이라는 주제는 스프링 부트가 어떻게 애플리케이션의 필수적인 인프라스트럭처 컴포넌트들을 자동으로 구성하는지에 초점을 맞춘 것입니다. 여기서 "인프라스트럭처 빈"이란 데이터베이스 연결, 메시지 브로커, 웹 서버 설정 등 애플리케이션 실행에 필수적인 백엔드 서비스들을 말합니다.

스프링 부트는 이러한 인프라스트럭처 빈들을 자동으로 생성하고 구성합니다. 이 과정에서 **`@AutoConfiguration`** 어노테이션과 조건부 설정인 **`@Conditional`** 어노테이션을 사용합니다. 하지만, 자동 구성이 항상 모든 사용 사례를 만족시킬 수는 없습니다. 때로는 개발자가 특정 요구 사항에 맞춰 이러한 자동 구성된 빈들을 대체하거나 수정해야 할 필요가 있습니다.

**`@Configuration`** 클래스와 외부 설정 파일(**`application.properties`** 또는 **`application.yml`**)은 이러한 사용자 정의 구성을 가능하게 합니다. **`@Configuration`**을 사용하여 사용자 정의 빈을 선언하고, 외부 설정을 통해 이 빈들의 속성을 조정할 수 있습니다. 이를 통해 개발자는 스프링 부트의 자동 구성을 기반으로 하면서도, 필요에 따라 특정 부분을 자신의 요구에 맞게 커스터마이즈할 수 있습니다.

따라서, "자동 구성 인프라스트럭처 빈"이라는 주제는 스프링 부트가 제공하는 자동화된 기본 설정을 넘어서, 개발자가 어떻게 그 설정을 확장하고 조정할 수 있는지를 다루고 있습니다. 이는 스프링 부트가 강력하면서도 유연한 프레임워크라는 점을 잘 보여줍니다.

도식에서 노란색 박스로 강조된 **`@Configuration`**과 **외부설정 프로퍼티 적용** 부분은 스프링 부트의 자동 구성 인프라스트럭처 빈을 사용자가 정의한 설정으로 대체하거나 조정하는 과정을 나타냅니다. 여기서 언급된 내용을 기반으로 설명드리겠습니다.

- **`@Configuration` 클래스**: 이 클래스는 자바 기반의 설정을 정의합니다. **`@Bean`** 어노테이션을 사용하여 메소드 레벨에서 빈을 선언할 수 있습니다. 스프링 부트의 자동 구성을 통해 제공되는 기본 빈들은 많은 상황에서 유용하지만, 경우에 따라서는 개발자가 이를 사용자 정의 빈으로 대체하거나 추가적인 빈을 등록하여 기능을 확장하고자 할 수 있습니다.
- **외부설정 프로퍼티 적용**: **`application.properties`** 또는 **`application.yml`** 파일을 통해 외부에서 빈의 속성 값을 설정할 수 있습니다. 이러한 외부 설정 파일은 빈의 속성을 재정의하거나, **`@Configuration`** 클래스 내에서 **`@Value`** 어노테이션 등을 통해 주입할 수 있는 값들을 제공합니다.

이러한 절차는 스프링 부트의 "의견이 강한" 자동 구성을 개발자의 구체적인 요구 사항에 맞게 조정할 수 있도록 하는 메커니즘입니다. 예를 들어, 스프링 부트는 특정 조건에서 데이터소스를 자동으로 구성하지만, 개발자는 **`@Configuration`** 클래스를 사용하여 다른 데이터소스를 정의하고 **`application.properties`** 파일에서 연결 세부 정보를 설정함으로써 이를 오버라이드할 수 있습니다.

결국 이 도식은 스프링 부트가 어떻게 자동 구성을 제공하고, 개발자가 이러한 자동 구성을 어떻게 사용자 정의 설정으로 조정할 수 있는지를 보여주는 것입니다.

### 유저 구성 애플리케이션 빈

"유저 구성 애플리케이션 빈"은 사용자 정의 빈 설정을 의미합니다. 여기서 언급된 과정은 스프링 프레임워크와 스프링 부트에서 어떻게 사용자가 직접 정의한 빈을 생성하고 애플리케이션 컨텍스트에 등록하는지를 보여줍니다.

스프링 부트는 많은 기본적인 빈을 자동으로 구성합니다(**`@AutoConfiguration`**), 하지만 때로는 애플리케이션의 특정 요구 사항에 맞추기 위해 이러한 자동 구성을 사용자가 수정하거나 추가할 필요가 있습니다. 이를 위해 **`@Configuration`** 어노테이션이 사용되며, 이는 개발자가 애플리케이션에 필요한 빈들을 직접 정의할 수 있도록 해줍니다.

**`@Configuration`** 클래스 내에는 하나 이상의 **`@Bean`** 어노테이션이 붙은 메소드들이 있을 수 있고, 이 메소드들은 빈 인스턴스를 반환합니다. 이러한 메소드들은 스프링 컨테이너에 의해 호출되고, 반환된 객체들은 애플리케이션 컨텍스트에 빈으로 등록됩니다.

이 과정을 통해, 개발자는 애플리케이션의 요구 사항에 맞는 데이터 소스, 서비스, 리포지토리 등과 같은 컴포넌트를 정의할 수 있으며, 이 컴포넌트들은 스프링 부트의 자동 구성에 의해 생성된 빈을 보완하거나 대체할 수 있습니다.

또한, **`application.properties`**나 **`application.yml`** 파일을 통해 빈의 속성 값을 외부에서 설정할 수 있으며, 이러한 외부 설정은 **`@Value`** 어노테이션 또는 **`@ConfigurationProperties`** 어노테이션을 사용하여 빈에 주입될 수 있습니다.

결론적으로, 도식은 스프링 부트에서 제공하는 풍부한 자동 구성 기능 외에도 개발자가 애플리케이션의 세부적인 요구 사항에 맞춰 빈을 사용자 정의할 수 있는 유연성을 보여줍니다.

### 두 가지 유형의 빈(Bean) 설정을 어떻게 조합할까?

<aside>
🗣️ 자동 구성 인프라 스트로처 빈과 우리가 직접 코드를 통해서 제공한 유저 구성 애플리케이션 빈, 애플리케이션 로직 빈과 인프라 스트로처 빈 , 이 두가지가 합쳐져서 결국은 SpringBoot로 우리가 개발하는 하나의 애플리케이션 구성 정보를 이루게 되는 것

</aside>

- 강의에서 언급된 내용은 스프링 부트가 애플리케이션을 구성하는 데 있어서 두 가지 유형의 빈(Bean) 설정을 어떻게 조합하는지를 설명하였음
- @Bean 이란 스프링 컨테이너에 의해 관리되는 객체를 말함
1. **자동 구성 인프라스트럭처 빈**
    - 스프링 부트는 **`@AutoConfiguration`** 어노테이션을 통해, 애플리케이션의 실행에 필수적인 인프라스트럭처 컴포넌트들(예: 데이터베이스 연결, 메시징 시스템, 웹 서버 설정 등)을 자동으로 구성하는 빈들을 제공
        - 이러한 자동 구성은 개발자가 매번 반복적으로 설정해야 하는 부담을 줄여줌
2. **유저 구성 애플리케이션 빈**
    - 개발자는 **`@Configuration`** 클래스를 통해 애플리케이션의 특정 요구 사항에 맞게 사용자 정의 빈을 생성할 수 있음
        - 이러한 빈들은 주로 애플리케이션의 비즈니스 로직을 수행하거나 특정 기능을 제공하는 데 사용됨

---

강의에서 말하는 "애플리케이션 구성 정보"는 이 두 가지 유형의 빈 설정이 결합하여 하나의 완성된 스프링 부트 애플리케이션을 만든다는 것을 의미합니다. 즉, 스프링 부트는 기본적인 인프라스트럭처를 자동으로 설정해주며, 개발자는 이 위에 비즈니스 로직이나 추가적인 기능을 구현하는 빈을 추가하여 애플리케이션을 완성시킵니다.

이렇게 함으로써, 스프링 부트는 개발자가 인프라스트럭처와 애플리케이션 로직의 구성에 대해 고민하는 시간을 줄이고, 빠르고 효율적으로 애플리케이션을 개발할 수 있는 환경을 제공합니다. 이는 스프링 부트가 개발자에게 제공하는 핵심 가치 중 하나입니다.